{"version":3,"sources":["activator.js"],"names":["document","addEventListener","clickAways","from","querySelectorAll","Array","controls","forEach","element","elementAriaControls","getAttribute","myClasses","split","i","length","elementComponentClass","concat","apply","indexOf","classList","add","querySelector","closest","event","stopPropagation","clickAwayActive","setAttribute","remove","body","activeAriaControls","this","activePanel","activeComponentClass","activeComponent","dataControl","control","dataClickAway","dataset","dataScrollLock","clickAway","scrollLock","e","deactivateToggle","windowWidth","window","innerWidth","deactivateResize","toggle","activeControlActive","ev","evt","key","closure","contains","activeSiblings","deactivateSiblings"],"mappings":"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","file":"activator.js","sourcesContent":["// CODEBASE v.4 ACTIVATOR\n// (An improvement over the Codebase 3 activator. Not backwards compatible.)\n// ~~~~~~~~~~~~~~~~~~~~~~\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  const clickAways = Array.from(document.querySelectorAll('[data-click-away=\"true\"]'));\n  const controls = Array.from(document.querySelectorAll('[class*=-control]'));\n  const closure = Array.from(document.querySelectorAll('[class*=-close]'));\n\n  // Find and decorate the click-away dismissers\n  clickAways.forEach(element => {\n    let elementAriaControls = element.getAttribute('aria-controls');\n    let myClasses = element.getAttribute('class').split(' ');\n    for (let i = 0; i < myClasses.length; i++) {\n      myClasses[i] = myClasses[i].split('-');\n    }\n    myClasses = [].concat.apply([], myClasses);\n    let elementComponentClass = '.' + myClasses[myClasses.indexOf('control') - 1] + '-wrapper';\n\n    element.classList.add('click-away');\n    document.querySelector('#' + elementAriaControls).classList.add('click-away');\n    if (document.querySelector('#' + elementAriaControls).closest(elementComponentClass) != null) {\n      document.querySelector('#' + elementAriaControls).closest(elementComponentClass).classList.add('click-away');\n    }\n  });\n\n  // Do something\n  controls.forEach(element => {\n    element.addEventListener('click', function (event) {\n\n      event.stopPropagation();\n\n      // You only need to uncomment this if you must have a “double duty” hyperlink, \n      // e.g. the first-click opens a sub-menu, then second-click follows the link.\n      // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n      // if (event.target.nodeName.toLowerCase() === 'a') {\n      //   if (!event.target.classList.contains('active')) {\n      //     event.preventDefault();\n      //   }\n      // }\n\n      let myClasses = this.getAttribute('class').split(' ');\n      for (let i = 0; i < myClasses.length; i++) {\n        myClasses[i] = myClasses[i].split('-');\n      }\n      myClasses = [].concat.apply([], myClasses);\n\n      let activeControlActive = this.classList.contains('active');\n      let activeAriaControls = this.getAttribute('aria-controls');\n      let activePanel = document.querySelector('#' + activeAriaControls);\n      let activeComponentClass = '.' + myClasses[myClasses.indexOf('control') - 1] + '-wrapper';\n      let activeComponent = activePanel.closest(activeComponentClass);\n      let dataControl = this.dataset.control;\n      let dataClickAway = this.dataset.clickAway;\n      let dataScrollLock = this.dataset.scrollLock;\n\n      const clickAway = () => {\n        let clickAwayActive = document.querySelectorAll('.click-away.active');\n        \n        clickAwayActive.forEach(element => {\n          element.classList.remove('active');\n          element.setAttribute(\"aria-expanded\", \"false\"); // if it has aria-expanded\n        });\n        // Disable any scroll lock\n        document.body.classList.remove('body-scroll-lock');\n      }\n      clickAway();\n\n      const documentClickAway = () => {\n        document.body.addEventListener('click', function (e) {\n          if (dataClickAway) {\n            clickAway();\n          }\n        });\n      }\n      documentClickAway();\n\n      const deactivateToggle = () => {\n        element.classList.remove('active');\n        element.setAttribute('aria-expanded', 'false');\n        activePanel.classList.remove('active');\n        if (activeComponent !== null) {\n          activeComponent.classList.remove('active');\n        }\n        document.body.classList.remove('body-scroll-lock');\n      }\n\n      // Deactivate siblings\n      // e.g. used in tabs, slideshows\n      const deactivateSiblings = () => {\n        let activeSiblings = activeComponent.querySelectorAll('.active')\n        for (let i = 0; i < activeSiblings.length; i++) {\n          activeSiblings[i].classList.remove('active');\n          activeSiblings[i].setAttribute(\"aria-expanded\", \"false\");\n        }\n      }\n\n      // Deactivate click-aways on window width resize\n      // -- because e.g. sometimes used on navicon menus \n      // that you don’t want activated above a particular \n      // breakpoint width\n      const deactivateResize = () => {\n        let windowWidth = window.innerWidth;\n        window.addEventListener('resize', function () {\n          if ( window.innerWidth !== windowWidth && dataClickAway === 'true') {\n            clickAway();\n          }\n        });\n      }\n      deactivateResize();\n\n      const activateScrollLock = () => {\n        if (dataScrollLock === 'true') {\n          document.body.classList.toggle('body-scroll-lock');\n        }\n      }\n      activateScrollLock();\n\n      // The Activators\n      // ~~~~~~~~~~~~~~\n      // Must be EITHER a toggle OR a tab\n\n      // Toggle has no siblings\n      // (but can have optional click-away)\n      if (dataControl === 'toggle') {\n        if (activeControlActive) {\n          element.classList.remove('active');\n          element.setAttribute('aria-expanded', 'false');\n          activePanel.classList.remove('active');\n          if (activeComponent !== null) {\n            activeComponent.classList.remove('active');\n          }\n        } else {\n          element.classList.add('active');\n          element.setAttribute('aria-expanded', 'true');\n          activePanel.classList.add('active');\n          if (activeComponent !== null) {\n            activeComponent.classList.add('active');\n          }\n\n          document.onkeydown = function(ev) {\n            ev = ev || window.event;\n            if ((ev.key === \"Escape\" || evt.key === \"Esc\")) {\n              deactivateToggle();\n            }\n          };\n\n          // Stop propagation when clicking activator panel\n          // (so that `click away` is not triggered)\n          [].forEach.call(document.querySelectorAll('[class*=\"-panel\"]'), function(element) {\n            element.addEventListener('click', function(event) {\n              event.stopPropagation();\n            });\n          });\n\n          // Deactivate on close (internal dismiss)\n          closure.forEach((element) => {\n            element.addEventListener('click', () => {\n              deactivateToggle();\n            });            \n          });\n\n        }\n      }\n      \n      // Tab only works if there is more than one tab\n      // (and assumes that one will start as `.active`)\n      if (dataControl === 'tab') {\n        if ( ! this.classList.contains('active')) {\n          clickAway();\n          deactivateSiblings();\n          this.classList.add('active');\n          this.setAttribute(\"aria-expanded\", \"true\");\n          activePanel.classList.add('active');\n        }\n      }\n\n    });    \n  });\n\n});"]}